#Директива определяющая имя базового образа для скачивания
FROM eclipse-temurin:11
#Директива для добавления метаинформации, которая описывает в каких портах нуждается наша программа
EXPOSE 8080
#Создает папку, если такой не существовало и переходит в нее
WORKDIR /opt/app
#Выполняет копирование данных из хостовой папки (build context), той, где лежит Dockerfile в указанную директорию
#Альтернативой является директива ADD, которая дополнительно умеет копировать и тут же распаковывать архивы, а так же скачивать
#данные по ссылкам
COPY /target/docker-0.0.1-SNAPSHOT.jar .
#Данная директива может вести себя по-разному. Зависит от того:
#- задали ли мы entrypoint
#- задали ли мы CMD
#- и от того, в какой форме мы запускаем команды (просто строкой или в exec-формате).
#entrypoint сложных образов переопределять не советуют, так как велика вероятность потерять логику,
#заложенную в базовый entrypoint создателем образа. Лучше использовать CMD.
ENTRYPOINT ["java", "-jar", "docker-0.0.1-SNAPSHOT.jar"]
#Такая связка entrypoint + cmd + exec-формат ведет себя довольно предсказуемо - склеивает все в одну большую команду.
#Параметры CMD можно переопределить при запуске контейнера.
CMD ["--spring.profiles.active=qa"]